/*
 * main.c
 *
 *  Created on: 2 wrz 2015
 *      Author: Bartek
 */

#include <avr/io.h>
#include <util/delay.h>
#include "HTU21D.h"
#include "I2C.h"
#include "MKUART/mkuart.h"
#include "avr/interrupt.h"

int8_t t_integer;
uint8_t t_fractional;
int8_t hum;
void SendTempUSART()
{
    uart_puts("Temperatura:  ");
    uart_putint( t_integer);
    uart_puts(".");
    uart_putint( t_fractional);
    uart_puts("\r\n");
}

void SendHumUSART()
{
    uart_puts("Wilgotnosc: ");
    uart_putint(hum);
    uart_puts("%\r\n");
}

void InterfaceInit()
{
	//TWI_Init(100000/100);
	USART_Init(__UBRR);
}

int main() {
	DDRB  = 1<<PB1;
	PORTB = 2;
	//InterfaceInit();
	//sei();
	//HTU21D_Init(Humidity11b_Temperature11b);
	//TWI_Start(HTU21D_SLA);
	//TWI_Stop();

	PORTB=2;
	while(1)
	{
		PORTB^=2;
		//uart_puts("Pomiar:\r\n");

		//HTU21D_StartTemperature();
		//HTU21D_StartHumidity();
		//_delay_ms(200);
		//hum = HTU21D_GetHumidity();
		//if( hum != -1){
		//SendHumUSART();}
		//else
			//uart_puts(" error ");
		//HTU21D_GetTemperature(&t_integer, &t_fractional);
		//SendTempUSART();
		_delay_ms(2000);

	}
}
