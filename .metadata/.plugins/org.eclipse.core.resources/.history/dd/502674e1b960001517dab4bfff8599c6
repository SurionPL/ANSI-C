/*
 * RTC.c

 *
 *  Created on: 2 wrz 2015
 *      Author: Bartlomiej Kusmierczyk
 *      Library for DS1307
 */

#include <avr/io.h>
#include <util/delay.h>
#include "I2C.h"
#include "RTC.h"




void RTC_Init(RTC_InitTypeDef* RTC_InitStruct)
{

}


void RTC_GetTemp(int8_t* integer, uint8_t* fract)
{
	uint8_t buffer = {0,0};

	TWI_ReadBytes(DS3231_SLA, DS3231_TEMP_MSB,2,buffer);
	/*uint8_t temporary = 0;
	TWI_Start();
	TWI_Write_SLA(DS3231_SLA);
	TWI_WriteByte(DS3231_TEMP_MSB);
	TWI_RStart();
	TWI_Write_SLA(DS3231_SLA + 1);
	*integer = TWI_ReadByte_ACK();
	temporary = TWI_ReadByte_NACK();
	TWI_Stop();
	if(temporary != 0)	temporary = (temporary >> 6) * 25;
	*fract = temporary;*/
	*integer |= buffer[0];
	if (buffer[1] != 0)
	*fract = (buffer[1] >> 6)*25;



}
